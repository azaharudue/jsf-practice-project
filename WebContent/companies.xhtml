<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">


<h:head>
	<meta charset="utf-8" name="viewport"
		content="width=device-width, initial-scale=1" />
	<h:outputStylesheet name="style.css" library="css" />
	<title>Companies</title>


</h:head>

<h:body>



	<!-- Use for a global message  -->
	<p:growl id="growl" redisplay="false" showDetail="true" />

	<h:form id="formCompany">

		<p:toolbar>
			<p:toolbarGroup>

				<!-- Add new Product Button -->
				<p:commandButton value="Add new company" icon="pi pi-plus"
					action="#{companyView.openNew}" update="dlgCompany, tblCompany"
					oncomplete="PF('dlgCompanyWidgetVar').show()"
					styleClass="ui-button-success " style="margin-right: .5rem">

					<p:resetInput target=":formCompany:pnlManageCompanyContent" />
				</p:commandButton>

				<!-- Delete Company Button -->

				<p:commandButton id="delete-companies-button"
					value="#{companyView.deleteButtonMessage}" icon="pi pi-trash"
					action="#{companyView.deleteSelectedCompanies}"
					styleClass="rounded-button ui-button-danger"
					disabled="#{!(companyView.hasSelectedCompanies())}">

					<p:confirm header="Confirmation"
						message="Delete the selected companies?"
						icon="pi pi-exclamation-triangle" />
				</p:commandButton>


			</p:toolbarGroup>
			<!--toolbar caret menu -->
			<p:toolbarGroup align="right" style="width: 10rem">
				<p:splitButton value="Navigate">
					<p:menuitem value="Product details" url="details.xhtml"
						icon="pi pi-external-link" />
					<p:menuitem value="Home(Products)" url="index.xhtml"
						icon="pi pi-home" />
				</p:splitButton>
			</p:toolbarGroup>
		</p:toolbar>


		<!-- Modal for adding a new company -->

		<p:dialog id="dlgCompany" header="Company Details" showEffect="fade"
			modal="true" widgetVar="dlgCompanyWidgetVar" responsive="true">

			<p:outputPanel id="pnlManageCompanyContent" class="ui-fluid"
				rendered="#{ companyView.selectedCompany ne null}">

				<p:messages redisplay="true" />


				<!-- company name -->
				<div class="p-field">
					<p:outputLabel for="companyName" value="Company Name" />
					<p:inputText id="companyName"
						value="#{companyView.selectedCompany.name}" required="true" />
				</div>
				<!-- company location -->
				<div class="p-field">
					<p:outputLabel for="companyLocation" value="Company Location" />
					<p:inputText id="companyLocation"
						value="#{companyView.selectedCompany.location}" required="true" />
				</div>

				

			</p:outputPanel>

			<f:facet name="footer">

				<!-- save  -->
				<p:commandButton value="Save" icon="pi pi-check"
					process="pnlManageCompanyContent @this"
					action="#{companyView.saveCompany}"
					update=" :formCompany:pnlManageCompanyContent">
					<p:resetInput target="pnlManageCompanyContent" />
				</p:commandButton>

				<!-- cancel  -->
				<p:commandButton value="Cancel" icon="pi pi-times"
					onclick="PF('dlgCompanyWidgetVar').hide()"
					class="ui-button-secondary">
					<p:resetInput target=":formCompany:pnlManageCompanyContent" />
				</p:commandButton>
			</f:facet>
		</p:dialog>


		<!-- Data table for companies  -->

		<p:dataTable id="tblCompany" widgetVar="tblCompaniesWidgetVar"
			var="tblVarCompany" value="#{companyView.companyLazyModel}" reflow="true"
			selection="#{companyView.selectedCompany}" selectionMode="single"
			rowKey="#{tblVarCompany.id}" selectionPageOnly="false"
			paginator="true" styleClass=" ui-datatable-companies" rows="10"
			rowSelectMode="checkbox" paginatorPosition="bottom"
			paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
            rowsPerPageTemplate="5,10,15"
			 lazy="true"			
			emptyMessage="No companies found with given criteria" >

			<!-- Ajax events -->


			<p:ajax event="rowSelect"
				update=":formCompany:delete-companies-button" />
			<p:ajax event="rowUnselect"
				update=":formCompany:delete-companies-button" />
			<p:ajax event="rowSelectCheckbox"
				update=":formCompany:delete-companies-button" />
			<p:ajax event="rowUnselectCheckbox"
				update=":formCompany:delete-companies-button" />
			<p:ajax event="toggleSelect"
				update=":formCompany:delete-companies-button" />


			<!-- Table header and global filter-->
			<f:facet name="header">
				<p:toolbar>
					<p:toolbarGroup class="p-d-flex p-ai-center p-jc-between">
						<h1>Companies</h1>
						<span align="left"><h:outputText
								value="Total available companies :#{companyView.companyLazyModel.rowCount}" /></span>
					</p:toolbarGroup>
					<p:toolbarGroup align="right">
						<span><h:outputText value="Search from the table" /></span>
						<span><p:inputText id="globalFilter"
								onkeyup="PF('tblCompaniesWidgetVar').filter()"
								style="width:20rem" placeholder="Enter keyword" /> </span>
					</p:toolbarGroup>
				</p:toolbar>

			</f:facet>
			<!-- Selection -->
			<p:column selectionMode="multiple" exportable="false"
				headerText="Select/Deselect All"
				styleClass="leftAlignedColumnContent" />

			<!-- id-->
			<p:column headerText="ID" styleClass="leftAlignedColumnContent" sortBy="#{tblVarCompany.id}">
				<h:outputText value="#{tblVarCompany.id}" />
			</p:column>



			<!-- Company name -->

			<p:column headerText="Company name" sortBy="#{tblVarCompany.name}"
				filterBy="#{tblVarCompany.name}"
				styleClass="leftAlignedColumnContent">
				<h:outputText value="#{tblVarCompany.name}" />

			</p:column>

			<!-- Company location -->

			<p:column headerText="Location"
				sortBy="#{tblVarCompany.location}"
				filterBy="#{tblVarCompany.location}"
				styleClass="leftAlignedColumnContent">
				<h:outputText value="#{tblVarCompany.location}" />

			</p:column>


			<!-- Edit pen -->
			<p:column styleClass="centeredColumnContent">
				<p:commandButton icon="pi pi-pencil" 
								process="@this"
								update=":formCompany:dlgCompany"
                                oncomplete="PF('dlgCompanyWidgetVar').show()"
                                styleClass="edit-button rounded-button ui-button-success" >
                    <f:setPropertyActionListener value="#{tblVarCompany}" target="#{companyView.selectedCompany}"/>
                    <p:resetInput target=":formCompany:pnlManageCompanyContent"/>
                </p:commandButton>                
               
			</p:column>
<!-- Delete column -->
			<p:column styleClass="centeredColumnContent"
				headerText="Delete product(s)">
				<p:commandButton class="ui-button-warning rounded-button"
					icon="pi pi-trash" process="@this"
					oncomplete="PF('dlgDeleteCompany').show()">

					<f:setPropertyActionListener value="#{tblVarCompany}"
						target="#{companyView.selectedCompany}" />
				</p:commandButton>




			</p:column>


		</p:dataTable>

		<p:confirmDialog widgetVar="dlgDeleteCompany" showEffect="fade"
			width="300" message="Delete the product?" header="Confirm"
			severity="warn">

			<p:commandButton value="Yes" icon="pi pi-check" process="@this"
				action="#{companyView.deleteCompany}"
				oncomplete="PF('dlgDeleteCompany').hide()" />

			<p:commandButton value="No" type="button"
				styleClass="ui-button-secondary" icon="pi pi-times"
				onclick="PF('dlgDeleteCompany').hide()" />

		</p:confirmDialog>

		<p:confirmDialog global="true" showEffect="fade" width="300">
			<p:commandButton value="Yes" type="button"
				styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
			<p:commandButton value="No" type="button"
				styleClass="ui-confirmdialog-no ui-button-secondary"
				icon="pi pi-times" />
		</p:confirmDialog>

		<!-- TO DO Features. -->
		<!-- 1.  (Dashboard) which company has how many products  -->
		<!-- 2.  (Geo Map) for company locations -->



	</h:form>

</h:body>


</html>